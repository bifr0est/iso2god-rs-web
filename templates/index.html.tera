<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iso2god-rs</title>
    <link rel="stylesheet" href="/public/style.css">
</head>
<body>
    <div class="container">
        <h1>iso2god-rs Web Interface</h1>
        <p class="subtitle">Convert Xbox 360 ISO files to Games on Demand format</p>
        <form id="conversion-form">
            <div class="form-group">
                <label>Source ISO:</label>
                <div class="source-toggle">
                    <label>
                        <input type="radio" name="source-type" value="select" checked>
                        Select from server
                    </label>
                    <label>
                        <input type="radio" name="source-type" value="upload">
                        Upload file
                    </label>
                </div>
            </div>
            <div class="form-group" id="select-iso-group">
                <label for="source-iso-path">Select ISO file(s):</label>
                <select id="source-iso-path" name="source-iso-path" multiple size="6">
                    <option value="">Loading ISO files...</option>
                </select>
                <small>Hold Ctrl/Cmd to select multiple files for batch conversion</small>
            </div>
            <div class="form-group" id="upload-iso-group" style="display: none;">
                <label for="source-iso">Upload ISO file(s):</label>
                <div id="drop-zone" class="drop-zone">
                    <div class="drop-zone-content">
                        <span class="drop-zone-icon">üìÅ</span>
                        <p>Drag & drop ISO files here</p>
                        <p>or</p>
                        <input type="file" id="source-iso" name="source-iso" accept=".iso" multiple>
                    </div>
                </div>
                <div id="upload-file-list"></div>
            </div>
            <div class="form-group">
                <label for="dest-dir">Destination Directory:</label>
                <input type="text" id="dest-dir" name="dest-dir" value="/data/output" required>
            </div>
            <div class="form-group">
                <label for="game-title">Game Title:</label>
                <input type="text" id="game-title" name="game-title">
            </div>
            <div class="form-group">
                <label for="trim-mode">Trim Mode:</label>
                <select id="trim-mode" name="trim-mode">
                    <option value="from-end">From End</option>
                    <option value="none">None</option>
                </select>
            </div>
            <div class="form-group">
                <label for="num-threads">Number of Threads:</label>
                <select id="num-threads" name="num-threads">
                    <option value="1" selected>1 (Safe for HDDs)</option>
                    <option value="2">2</option>
                    <option value="4">4</option>
                    <option value="8">8 (Good for SSDs)</option>
                    <option value="auto">Auto (Use All Cores)</option>
                </select>
            </div>
            <div class="form-group">
                <input type="checkbox" id="dry-run" name="dry-run">
                <label for="dry-run">Dry Run</label>
            </div>

            <div class="form-group auto-transfer-toggle">
                <input type="checkbox" id="auto-transfer" name="auto-transfer">
                <label for="auto-transfer">üì§ Auto-Transfer to Xbox 360 after conversion</label>
            </div>

            <div id="ftp-settings-inline" style="display: none;">
                <div class="ftp-inline-box">
                    <h4>üéÆ Xbox 360 FTP Settings</h4>
                    <div class="form-group">
                        <label for="ftp-host-inline">Xbox IP Address:</label>
                        <input type="text" id="ftp-host-inline" placeholder="192.168.1.100">
                    </div>
                    <div class="form-group">
                        <label for="ftp-port-inline">FTP Port:</label>
                        <input type="number" id="ftp-port-inline" value="21" min="1" max="65535">
                    </div>
                    <div class="form-group">
                        <label for="ftp-username-inline">Username:</label>
                        <input type="text" id="ftp-username-inline" placeholder="xbox" value="xbox">
                    </div>
                    <div class="form-group">
                        <label for="ftp-password-inline">Password:</label>
                        <input type="password" id="ftp-password-inline" placeholder="xbox" value="xbox">
                    </div>
                    <div class="form-group">
                        <label for="ftp-target-path-inline">Target Path on Xbox:</label>
                        <input type="text" id="ftp-target-path-inline" placeholder="/Hdd1/Games" value="/Hdd1/Games">
                        <small>Common: /Hdd1/Games, /Hdd1/Content/0000000000000000</small>
                    </div>
                    <div class="form-group">
                        <input type="checkbox" id="ftp-passive-mode" name="ftp-passive-mode">
                        <label for="ftp-passive-mode">Use Passive Mode (recommended for NAT/firewall)</label>
                    </div>
                    <div class="form-group">
                        <button type="button" id="test-ftp-btn" class="btn-secondary">üîå Test Connection</button>
                        <span id="ftp-test-result"></span>
                    </div>
                </div>
            </div>

            <button type="submit" id="convert-btn">Convert</button>
        </form>

        <!-- Batch Progress Container -->
        <div id="batch-progress-container" style="display: none;">
            <h3>üì¶ Batch Conversion Progress</h3>
            <div id="batch-status">
                <span id="batch-current">0</span> / <span id="batch-total">0</span> files
            </div>
            <div id="batch-list"></div>
        </div>

        <div id="progress-container" style="display: none;">
            <div class="progress-header">
                <h3>Converting...</h3>
                <span id="progress-text">0%</span>
            </div>
            <div class="progress-bar">
                <div id="progress-fill"></div>
            </div>
            <p id="progress-message">Preparing conversion...</p>
        </div>

        <div id="status"></div>

        <div id="conversion-history">
            <h3>Recent Conversions</h3>
            <div id="history-list"></div>
        </div>
    </div>
    <script src="/public/script.js"></script>
</body>
</html>
